(function(e){e.fn.stickyscroll=function(t){if(!this.length)return this;t=e.extend({fixedTop:0,fixedBottom:0},t||{});this.each(function(){var n=this,r=false,i=t.fixedTop||0,s=t.fixedBottom||0,o=0;if(!e.isNumeric(t.fixedTop)){i=0;e(t.fixedTop).each(function(){i+=e(this).outerHeight()})}if(!e.isNumeric(t.fixedBottom)){s=0;e(t.fixedBottom).each(function(){s+=e(this).outerHeight()})}var u=e(this).css({width:e(this).width(),height:e(this).height()}),a={top:u.offset().top,width:u.width()},f=u.wrapInner('<div class="floater"></div>').find("> .floater"),l=function(){r=f.outerHeight()>e(window).height()-i-s};f.css({position:"fixed",inset:"visible",left:a.left,top:a.top,width:a.width});e(window).on("scroll touchmove",function(){if(r){a.height=f.outerHeight();var t=f.offset().top,n=e(this).scrollTop()+i,l=e(this).height(),c={top:t-n,bottom:l-(t-n+a.height)-i-s};if(n>o){var h=u.outerHeight();if(n>a.top+h-l+i+s){f.css({position:"absolute",top:a.top+h-a.height});console.log("ab spill")}else if(c.bottom<0){f.css({position:"absolute",top:t})}else{f.css({position:"fixed",top:Math.max(c.top,l-a.height)-s})}}else if(n<o){if(n<a.top){f.css({position:"absolute",top:a.top})}else if(c.top<0){f.css({position:"absolute",top:t})}else{f.css({position:"fixed",top:Math.min(0,c.top)+i})}}}else{f.css({position:"fixed",top:a.top})}o=n});e(window).on("resize",function(){l()});l()})}})(jQuery)
